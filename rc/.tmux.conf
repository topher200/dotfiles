### settings ###

# better re-sizing
set-window-option -g aggressive-resize on

# vi mode
set-window-option -g mode-keys vi

# 0 is too far from '`'
set -g base-index 1
set-window-option -g pane-base-index 1

# mouse behavior
set-option -g mouse on
bind-key -n WheelUpPane if-shell -F -t = "#{mouse_any_flag}" "send-keys -M" "if -Ft= '#{pane_in_mode}' 'send-keys -M' 'copy-mode -e'"
# use focus events
set-option -g focus-events on
# fix terminal colors
set-option -g default-terminal "screen-256color"
# set terminal title
set-option -g set-titles on
set-option -g set-titles-string '#S: #W'
set-window-option -g automatic-rename on
# increase scrollback lines
set-option -g history-limit 50000
# status bar settings (utf8, message display time[ms], update interval)
set-option -g status-interval 5
set-option -g display-time 4000
set-option -g status-left-length 20
set-option -g status-right '%Y-%m-%d %I:%M%p'

#### COLOR THEME
# status bar
set-option -g status-bg colour2
set-option -g status-fg black
set-option -g status-left-fg black
# default window titles
set-window-option -g window-status-attr dim
# active window title
set-window-option -g window-status-current-fg colour50
set-window-option -g window-status-current-attr bright
# window activity
set-window-option -g window-status-activity-fg colour19
set-window-option -g window-status-activity-bg colour03
set-window-option -g window-status-bell-fg colour01
set-window-option -g window-status-bell-bg default
# messaging
set-option -g message-bg colour04
set-option -g message-fg colour19
# command prompt
set-option -g message-command-bg colour04
set-option -g message-command-fg colour19
# pane numbers
set-option -g display-panes-active-colour colour02
set-option -g display-panes-colour colour07
# pane borders
set-option -g pane-active-border-fg colour07
set-option -g pane-border-fg colour07
# clock
set-window-option -g clock-mode-colour colour05

### end settings ###

### mappings ###

# remap prefix to Control + a
set -g prefix C-a
unbind C-b
bind-key C-a send-prefix

# force a reload of the config file
unbind r
bind-key r source-file ~/.tmux.conf \; display "Reloaded!"

# better pane splitting
bind-key s split-window -v
bind-key v split-window -h

# select next pane with S-Tab. if we're maximized, stay maximized
bind-key -n BTab run-shell "if [[ `tmux list-panes -F '#F' | grep Z` ]]; then (tmux select-pane -t :.+ ; tmux resize-pane -Z); else tmux select-pane -t :.+; fi;"

# select windows without prefix
bind-key -n C-1 select-window -t :=1
bind-key -n C-2 select-window -t :=2
bind-key -n C-3 select-window -t :=3
bind-key -n C-4 select-window -t :=4
bind-key -n C-5 select-window -t :=5
bind-key -n C-6 select-window -t :=6
bind-key -n C-7 select-window -t :=7
bind-key -n C-8 select-window -t :=8
bind-key -n C-9 select-window -t :=9

# copy mode QOL keybindings
bind-key -T copy-mode-vi 'v' send -X begin-selection
bind-key -T copy-mode-vi 'y' send -X copy-selection
bind-key -T copy-mode-vi 'u' send -X halfpage-up
bind-key -T copy-mode-vi 'd' send -X halfpage-down
bind-key 'u' copy-mode \; send -X halfpage-up
bind-key 'k' copy-mode \; send-keys -X cursor-up

# forward 'C-a n' or 'C-a p' to window (when using a remote's 'screen' session inside tmux)
bind-key 'n' send-keys C-a n
bind-key 'p' send-keys C-a p

# using F1 and F2 for previous/next window. these are sent by iterm2 keybindings
bind-key 9 select-window -p
bind-key 0 select-window -n

### end mappings ###

### plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-logging'

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'